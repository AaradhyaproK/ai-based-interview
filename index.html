<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoadFurey AI Interview Platform</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dzj2wcui1/image/upload/v1744563145/voc5gbr1g6ucgufrmko7.png">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <!-- Your Script (defer ensures it runs after HTML is parsed) -->
    <script src="script.js" defer></script>
</head>
<body>
    <header class="container">
       <h1>CodeFurey</h1>
    </header>

    <div id="global-loading" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <div id="global-error" class="error-message container" style="display: none;"></div>

    <main id="main-content" class="container">

        <!-- 1. Authentication -->
        <section id="auth-section" style="display: none;">
            <h2>Welcome</h2>
            <div id="auth-error" class="error-message" style="display: none;"></div>
            <div id="auth-message" class="message" style="display: none;"></div>

            <!-- Login Form -->
            <form id="login-form" style="display: block;">
                <h3>Login</h3>
                <div class="form-group">
                    <label for="login-email">Email:</label>
                    <input type="email" id="login-email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Password:</label>
                    <input type="password" id="login-password" required>
                </div>
                <button type="submit" id="login-btn" class="btn primary-btn">Login</button>
                <p><a href="#" id="forgot-password-link">Forgot Password?</a></p>
                <p>Don't have an account? <a href="#" id="show-signup-link">Sign Up</a></p>
            </form>

            <!-- Signup Form -->
            <form id="signup-form" style="display: none;">
                <h3>Sign Up</h3>
                <div class="form-group">
                    <label for="signup-fullname">Full Name:</label>
                    <input type="text" id="signup-fullname" required>
                </div>
                <div class="form-group">
                    <label for="signup-email">Email:</label>
                    <input type="email" id="signup-email" required>
                </div>
                <div class="form-group">
                    <label for="signup-password">Password (min 6 chars):</label>
                    <input type="password" id="signup-password" required minlength="6">
                </div>
                 <div class="form-group">
                    <label for="signup-experience">Years of Experience:</label>
                    <input type="number" id="signup-experience" required min="0">
                </div>
                <div class="form-group">
                    <label for="signup-role">Role:</label>
                    <select id="signup-role" required>
                        <option value="" disabled selected>Select Role...</option>
                        <option value="candidate">Candidate</option>
                        <option value="recruiter">Recruiter</option>
                    </select>
                </div>
                <button type="submit" id="signup-btn" class="btn primary-btn">Sign Up</button>
                <p>Already have an account? <a href="#" id="show-login-link">Login</a></p>
            </form>

            <!-- Forgot Password Form -->
            <form id="forgot-password-form" style="display: none;">
                 <h3>Reset Password</h3>
                 <div class="form-group">
                     <label for="reset-email-input">Enter your Email:</label>
                     <input type="email" id="reset-email-input" required>
                 </div>
                 <button id="reset-password-btn" class="btn primary-btn">Send Reset Link</button>
                 <p><a href="#" id="back-to-login-link">Back to Login</a></p>
             </form>
        </section>

        <!-- 2. User Info Header (Displayed when logged in) -->
        <section id="user-info" class="user-info-header" style="display: none;">
            <div>
                Logged in as: <strong id="user-fullname"></strong> (<span id="user-email"></span>)
                | Role: <span id="user-role"></span>
                | Experience: <span id="user-experience"></span> yrs
            </div>
            <button id="logout-btn" class="btn secondary-btn small-btn">Logout</button>
        </section>

        <!-- 3. Recruiter Dashboard -->
        <section id="recruiter-dashboard" style="display: none;">
            <h2>Recruiter Dashboard</h2>

            <!-- Post Job -->
            <section id="post-job-section" class="dashboard-section">
                <h3>Post a New Job</h3>
                 <form id="post-job-form">
                     <div class="form-group">
                         <label for="job-title">Job Title:</label>
                         <input type="text" id="job-title" required>
                     </div>
                     <div class="form-group">
                         <label for="job-description">Job Description:</label>
                         <textarea id="job-description" rows="4" required></textarea>
                     </div>
                     <button type="submit" id="post-job-btn" class="btn primary-btn">Post Job</button>
                     <div id="post-job-msg" class="inline-msg" style="display: none;"></div>
                 </form>
            </section>

            <!-- View Jobs & Candidates -->
            <section class="dashboard-section">
                <h3>Your Posted Jobs</h3>
                <div id="recruiter-jobs-list" class="item-list">
                    <!-- Jobs loaded here -->
                </div>
            </section>

            <section class="dashboard-section">
                 <h3>Candidates for: <span id="selected-job-title-recruiter">(Select job)</span></h3>
                <div id="candidates-list" class="item-list">
                     <p class="list-empty-msg">Select a job above to see candidates.</p>
                    <!-- Candidates loaded here -->
                </div>
            </section>
        </section>

        <!-- 4. Candidate Dashboard -->
        <section id="candidate-dashboard" style="display: none;">
            <h2>Candidate Dashboard</h2>

             <section class="dashboard-section">
                 <h3>Available Jobs</h3>
                 <div id="available-jobs-list" class="item-list">
                     <!-- Available jobs loaded here -->
                 </div>
             </section>

             <section class="dashboard-section">
                 <h3>My Interview History</h3>
                 <div id="my-interviews-list" class="item-list">
                     <!-- Candidate's interviews loaded here -->
                 </div>
             </section>
        </section>

        <!-- 5. Resume Upload Section -->
        <section id="resume-upload-section" class="centered-section" style="display: none;">
            <h2>Start Interview for: <span id="resume-prompt-job-title"></span></h2>
            <p>Please upload your resume as a JPG or PNG image (Max 5MB).</p>
            <input type="hidden" id="resume-upload-job-id">
            <div class="form-group">
                <label for="interview-resume-input">Select Resume Image:</label>
                <input type="file" id="interview-resume-input" accept="image/jpeg, image/png">
            </div>
            <div id="interview-resume-status" class="message inline-msg"></div>
            <div id="resume-upload-error" class="error-message inline-msg" style="display: none;"></div>
            <div class="button-group">
                 <button id="upload-resume-and-start-btn" class="btn primary-btn">Upload & Start</button>
                 <button id="cancel-interview-start-btn" class="btn secondary-btn">Cancel</button>
             </div>
        </section>

        <!-- 6. Interview Section -->
        <section id="interview-section" style="display: none;">
            <h2>Interview for: <span id="interview-job-title"></span></h2>

            <div id="interview-loading" class="loading" style="display: none;">Loading Interview...</div>
            <div id="interview-error" class="error-message" style="display: none;"></div>

            <div id="interview-qa-area" style="display: none;">
                <h3 id="question-title">Question X of Y:</h3>
                <p id="question-text" class="question-box">Loading question...</p>

                <div id="video-area">
                    <video id="webcam-feed" autoplay muted playsinline></video>
                    <div id="recording-controls">
                        <span id="recording-status">Ready</span>
                        <span id="question-timer-display" class="timer-display hidden"></span> <!-- Timer Display -->
                        <button id="start-recording-btn" class="btn primary-btn" disabled>Start Recording</button> <!-- Initially disabled until ready -->
                        <button id="stop-recording-btn" class="btn danger-btn" disabled>Stop Recording</button>
                    </div>
                     <p id="stt-simulation-note" class="message inline-msg" style="display: none;">(Note: Answer text is simulated based on video upload. Full transcription requires a backend service.)</p>
                     <div id="loading-answer" class="loading" style="display: none;">Processing Answer...</div>
                </div>

                <div class="navigation-controls">
                    <button id="next-question-btn" class="btn primary-btn" style="display: none;" disabled>Next Question</button>
                    <button id="finish-interview-btn" class="btn primary-btn" style="display: none;" disabled>Finish Interview</button>
                </div>
            </div>
        </section>

        <!-- 7. Report Section -->
        <section id="report-section" style="display: none;">
             <div class="report-header">
                 <h2>Interview Report</h2>
                 <button id="back-to-dashboard-btn" class="btn secondary-btn small-btn">← Back to Dashboard</button>
             </div>

            <p><strong>Job Title:</strong> <span id="report-job-title"></span></p>
            <p><strong>Candidate:</strong> <span id="report-candidate-email"></span></p>
            <p><strong>Status:</strong> <span id="report-status" class="interview-status"></span></p>
            <p id="report-resume-link-area" style="display: none;">
                <strong>Resume:</strong> <a id="report-resume-link" href="#" target="_blank" rel="noopener noreferrer" class="link-style">View Uploaded Resume</a>
            </p>

            <!-- Recruiter Only: Status Update -->
             <div id="recruiter-status-update" style="display: none; margin-top: 20px; padding: 15px; border: 1px solid #ccc; border-radius: 5px;">
                 <h4>Update Candidate Status</h4>
                 <div class="form-group">
                     <label for="update-status-select">Status:</label>
                     <select id="update-status-select">
                         <option value="Pending">Pending</option>
                         <option value="Reviewed">Reviewed</option>
                         <option value="Selected">Selected</option>
                         <option value="Rejected">Rejected</option>
                         <option value="On Hold">On Hold</option>
                     </select>
                 </div>
                 <div class="form-group">
                     <label for="status-notes">Notes (Optional):</label>
                     <textarea id="status-notes" rows="2"></textarea>
                 </div>
                 <button id="update-status-btn" class="btn primary-btn small-btn">Update Status</button>
                 <div id="update-status-msg" class="inline-msg" style="display: none;"></div>
             </div>

            <div id="feedback-area" style="margin-top: 20px;">
                <h3>AI Feedback & Analysis</h3>
                <div id="loading-feedback" class="loading" style="display: none;">Loading Feedback...</div>
                <div id="error-feedback" class="error-message" style="display: none;"></div>
                <div id="feedback-content" style="display: none;">
                    <!-- Feedback loaded here -->
                </div>
            </div>

            <div id="report-content" style="margin-top: 20px;">
                <h3>Questions & Answers</h3>
                <!-- Q&A loaded here -->
            </div>
        </section>

    </main>

    <footer class="container">
        <p>© 2025 Team CodeFurey. All rights reserved.</p>
        <img id="logo-main" src="https://res.cloudinary.com/dzj2wcui1/image/upload/v1744563145/voc5gbr1g6ucgufrmko7.png" alt="">
    </footer>
</body>
</html>